//
//  ZRGoupBuyingReviewFrame.m
//  zhiruProduct
//
//  Created by nanding on 16/7/22.
//  Copyright © 2016年 Zhiru. All rights reserved.
//

#import "ZRGoupBuyingReviewFrame.h"
#import "ZRCommentListModel.h"

@implementation ZRGoupBuyingReviewFrame


//-(void)setReviewText:(NSString *)reviewText
//{
//    _reviewText = reviewText;
//    
//    //计算评论内容尺寸
//    [self caculateReviewTextFrame];
//    
//    _cellHeight = CGRectGetMaxY(_reviewGoodFrame)+15;
//    
//}

//-(void)setReviewPicArr:(NSArray *)reviewPicArr
//{
//    _reviewPicArr = reviewPicArr;
//    
//}


-(void)setCommentListModel:(ZRCommentListModel *)commentListModel
{
    _commentListModel = commentListModel;
    
    //计算评论内容尺寸
    [self caculateReviewTextFrame];
    
    _cellHeight = CGRectGetMaxY(_reviewGoodFrame)+15;
    
}


- (void)caculateReviewTextFrame
{
    //头像
    CGFloat imageX = 15;
    CGFloat imageY = 10;
    CGFloat imageWH = ZRImage(@"_commentListModel.commentUserImg").size.width*SCREEN_WIDTH/375;
    _reviewIconFrame = CGRectMake(imageX, imageY, imageWH, imageWH);
    
    //昵称
    CGSize nameSize = [NSString getSize:_commentListModel.commentUserName strFont:[UIFont systemFontOfSize:15] maxSize:CGSizeMake(SCREEN_WIDTH,SCREEN_HEIGHT)];
    _reviewNameFrame = CGRectMake(imageX*2+imageWH, imageY, nameSize.width, nameSize.height);
    
    //时间
    CGSize timeSize = [NSString getSize:_commentListModel.commentDate strFont:[UIFont systemFontOfSize:12] maxSize:CGSizeMake(SCREEN_WIDTH,SCREEN_HEIGHT)];
    _reviewTimeFrame = CGRectMake(SCREEN_WIDTH-15-timeSize.width, 20, timeSize.width, timeSize.height);
    
    //评星
    _reviewStarFrame = CGRectMake(imageX*2+imageWH, 10*2+nameSize.height, ZRImage(@"pingxing").size.width, ZRImage(@"pingxing").size.height);
    
    //价格
    CGSize priceSize = [NSString getSize:_commentListModel.perCapita strFont:[UIFont systemFontOfSize:12] maxSize:CGSizeMake(SCREEN_WIDTH,SCREEN_HEIGHT)];
    _reviewPriceFrame = CGRectMake(CGRectGetMaxX(_reviewStarFrame)+10, 10*2+nameSize.height, priceSize.width, priceSize.height);
    
    //内容
    CGFloat textWidth = SCREEN_WIDTH-15-imageX*2-imageWH;
    CGSize textSize = [NSString getSize:_commentListModel.commentContent strFont:[UIFont systemFontOfSize:12] maxSize:CGSizeMake(textWidth,SCREEN_HEIGHT)];
    _reviewTextFrame = CGRectMake(imageX*2+imageWH, CGRectGetMaxY(_reviewStarFrame)+10, textWidth, textSize.height);
    
    //配图
    if (_commentListModel.commentImg.count>0) {
        CGFloat picX = imageX*2+imageWH;
        CGFloat picY = CGRectGetMaxY(_reviewTextFrame)+10;
        CGSize photosSize = [self photosSizeWithCount:(int)_commentListModel.commentImg.count];
        _reviewPicFrame = CGRectMake(picX, picY, photosSize.width, photosSize.height);
        
    }
    
    //点赞
    _reviewGoodFrame = CGRectMake(256*SCREEN_WIDTH/375, CGRectGetMaxY(_reviewPicFrame)+15, ZRImage(@"haoping").size.width, ZRImage(@"haoping").size.height);
    
    //反对点赞
    _reviewBadFrame = CGRectMake(320*SCREEN_WIDTH/375, CGRectGetMaxY(_reviewPicFrame)+15, ZRImage(@"chaping").size.width, ZRImage(@"chaping").size.height);
}


#pragma mark - 计算配图的尺寸
- (CGSize)photosSizeWithCount:(int)count
{
    // 获取总列数
    int cols = count == 4? 3 : 2;
    // 获取总行数 = (总个数 - 1) / 总列数 + 1
    int rols = (count - 1) / cols + 1;
    CGFloat photoWH = 80*SCREEN_WIDTH/375;
    CGFloat w = cols * photoWH + (cols - 1) * 10;
    CGFloat h = rols * photoWH + (rols - 1) * 10;
    
    
    return CGSizeMake(w, h);
    
}



@end
